<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('博客论坛列表')" />
    <style>
        .card-bg {
            background-color: #ffffff; /* You can change the color as needed */
            border: 1px solid #ddd; /* Add a border */
            border-radius: 5px; /* Optional: Add rounded corners */
            padding: 15px; /* Optional: Add padding inside the card */
            margin-bottom: 15px; /* Optional: Add space between cards */
        }
        .card-container {
            margin-top: 20px; /* Adjust the value as needed */
        }
        .btn-margin {
            margin-right: 10px; /* Adjust the value as needed */
            margin-top: 20px; /* Adjust the value as needed */
        }
        .card-title {
            font-weight: bold;
        }
    </style>
</head>
<body class="gray-bg">
<div class="container-div">
    <div class="btn-group-sm" id="toolbar" role="group">
        <a class="btn btn-success btn-margin" onclick="$.operate.add()" shiro:hasPermission="blogs:blogs:add">
            <i class="fa fa-plus"></i> 写博客
        </a>
        <a class="btn btn-warning btn-margin" onclick="$.table.exportExcel()" shiro:hasPermission="blogs:blogs:export">
            <i class="fa fa-download"></i> 导出
        </a>
    </div>

        <!-- <div class="col-sm-12 select-table table-striped">
    <table id="bootstrap-table"></table>
</div> -->

        <!-- 新增卡片样式的容器 -->
        <div class="col-sm-12 card-container" id="card-container">
        </div>

    </div>
</div>
<th:block th:include="include :: footer" />
<script th:inline="javascript">
    var editFlag = [[${@permission.hasPermi('blogs:blogs:edit')}]];
    var removeFlag = [[${@permission.hasPermi('blogs:blogs:remove')}]];
    var prefix = ctx + "blogs/blogs";

    $(function() {
        var options = {
            url: prefix + "/list",
            createUrl: prefix + "/add",
            updateUrl: prefix + "/edit/{id}",
            removeUrl: prefix + "/remove",
            exportUrl: prefix + "/export",
            modalName: "博客论坛",
            columns: [{
                checkbox: true
            },
                {
                    field: 'id',
                    title: '主键',
                    visible: false
                },
                {
                    field: 'username',
                    title: '用户名称'
                },
                {
                    field: 'title',
                    title: '文章标题'
                },
                {
                    field: 'content',
                    title: '正文'
                },
                {
                    field: 'likes',
                    title: '点赞'
                },
                {
                    field: 'createAt',
                    title: '发布时间'
                },
                {
                    title: '操作',
                    align: 'center',
                    formatter: function(value, row, index) {
                        var actions = [];
                        actions.push('<a class="btn btn-success btn-xs ' + editFlag + '" href="javascript:void(0)" onclick="$.operate.edit(\'' + row.id + '\')"><i class="fa fa-edit"></i>编辑</a> ');
                        actions.push('<a class="btn btn-danger btn-xs ' + removeFlag + '" href="javascript:void(0)" onclick="$.operate.remove(\'' + row.id + '\')"><i class="fa fa-remove"></i>删除</a>');
                        return actions.join('');
                    }
                }]
        };
        $.table.init(options);

        // 动态生成卡片内容
        $.ajax({
            url: options.url,
            type: 'POST',
            success: function(data) {
                var cardContainer = $('#card-container');
                data.rows.forEach(function(row) {
                    var card = `
                        <div class="card card-bg">
                            <div class="card-body">
                                <h1 class="card-title">${row.title}</h1>
                                <h3 class="card-subtitle mb-2 text-muted">作者：${row.username}</h3>
                                <hr>
                                <p class="card-text">${row.content}</p>
                                <p class="card-text"><small class="text-muted">发布时间: ${row.createAt}</small></p>
                                <a href="javascript:void(0)" class="card-link btn btn-danger btn-xs ${removeFlag}" onclick="$.operate.remove('${row.id}')"><i class="fa fa-remove"></i> 删除</a>
                            </div>
                        </div>
                    `;
                    cardContainer.append(card);
                });
            }
        });
    });
</script>
</body>
</html>